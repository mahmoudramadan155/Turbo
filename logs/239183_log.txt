Namespace(batch_size=400, bce_lambda=1.0, bec_p=0.0, bec_p_dec=0.0, ber_lambda=1.0, block_len=100, block_len_high=200, block_len_low=10, bsc_p=0.0, bsc_p_dec=0.0, channel='awgn', code_rate_k=1, code_rate_n=3, dec_act='linear', dec_kernel_size=5, dec_lr=0.001, dec_num_layer=5, dec_num_unit=100, dec_rnn='gru', decoder='TurboAE_rate3_cnn', demod_lr=0.005, demod_num_layer=1, demod_num_unit=20, dropout=0.0, enc_act='elu', enc_clipping='both', enc_grad_limit=0.01, enc_kernel_size=5, enc_lr=0.001, enc_num_layer=2, enc_num_unit=100, enc_quantize_level=2, enc_rnn='gru', enc_truncate_limit=0, enc_value_limit=1.0, encoder='TurboAE_rate3_cnn', extrinsic=1, focal_alpha=1.0, focal_gamma=0.0, img_size=10, init_nw_weight='default', is_interleave=1, is_k_same_code=False, is_parallel=0, is_same_interleaver=1, is_variable_block_len=False, joint_train=0, k_same_code=2, lambda_maxBCE=0.01, loss='bce', mod_lr=0.005, mod_num_layer=1, mod_num_unit=20, mod_pc='block_power', mod_rate=2, momentum=0.9, no_code_norm=False, no_cuda=False, num_ber_puncture=5, num_block=10000, num_epoch=1, num_iter_ft=5, num_iteration=6, num_train_dec=5, num_train_demod=5, num_train_enc=1, num_train_mod=1, optimizer='adam', precompute_norm_stats=False, print_pos_ber=False, print_pos_power=False, print_test_traj=False, radar_power=5.0, radar_prob=0.05, rec_quantize=False, rec_quantize_level=2, rec_quantize_limit=1.0, snr_points=12, snr_test_end=4.0, snr_test_start=-1.5, test_channel_mode='block_norm', test_ratio=1, train_channel_mode='block_norm', train_dec_channel_high=2.0, train_dec_channel_low=-1.5, train_enc_channel_high=1.0, train_enc_channel_low=1.0, vv=5)
using random interleaver [26 86  2 55 75 93 16 73 54 95 53 92 78 13  7 30 22 24 33  8 43 62  3 71
 45 48  6 99 82 76 60 80 90 68 51 27 18 56 63 74  1 61 42 41  4 15 17 40
 38  5 91 59  0 34 28 50 11 35 23 52 10 31 66 57 79 85 32 84 14 89 19 29
 49 97 98 69 20 94 72 77 25 37 81 46 39 65 58 12 88 70 87 36 21 83  9 96
 67 64 47 44] [18 29 64 92 72 87  5 15 12 17 61 76  9 78 80  7 33  6 37 74 79  1 45 28
 60 52 25 39 97 44 16 55 83 49 22 70 47  4 82 94 53 66 26 84 31 63  8 75
 98 57 71 99 86 96 69 24 30 13 40 56 68 95 81 19 38 91 54 32 51 85 11 89
 90 36 65 88 41 14 27 50 20 46 67 35 62  2 59 23 58 43 10  0 73 21 77 42
  3 93 48 34]
Channel_AE(
  (enc): ENC_interCNN(
    (enc_cnn_1): SameShapeConv1d(
      (cnns): ModuleList(
        (0): Conv1d(1, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
      )
    )
    (enc_cnn_2): SameShapeConv1d(
      (cnns): ModuleList(
        (0): Conv1d(1, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
      )
    )
    (enc_cnn_3): SameShapeConv1d(
      (cnns): ModuleList(
        (0): Conv1d(1, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
      )
    )
    (enc_linear_1): Linear(in_features=100, out_features=1, bias=True)
    (enc_linear_2): Linear(in_features=100, out_features=1, bias=True)
    (enc_linear_3): Linear(in_features=100, out_features=1, bias=True)
    (interleaver): Interleaver()
  )
  (dec): DEC_LargeCNN(
    (interleaver): Interleaver()
    (deinterleaver): DeInterleaver()
    (dec1_cnns): ModuleList(
      (0): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (1): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (2): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (3): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (4): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (5): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
    )
    (dec2_cnns): ModuleList(
      (0): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (1): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (2): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (3): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (4): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
      (5): SameShapeConv1d(
        (cnns): ModuleList(
          (0): Conv1d(7, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (1): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (2): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (3): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
          (4): Conv1d(100, 100, kernel_size=(5,), stride=(1,), padding=(2,))
        )
      )
    )
    (dec1_outputs): ModuleList(
      (0): Linear(in_features=100, out_features=5, bias=True)
      (1): Linear(in_features=100, out_features=5, bias=True)
      (2): Linear(in_features=100, out_features=5, bias=True)
      (3): Linear(in_features=100, out_features=5, bias=True)
      (4): Linear(in_features=100, out_features=5, bias=True)
      (5): Linear(in_features=100, out_features=5, bias=True)
    )
    (dec2_outputs): ModuleList(
      (0): Linear(in_features=100, out_features=5, bias=True)
      (1): Linear(in_features=100, out_features=5, bias=True)
      (2): Linear(in_features=100, out_features=5, bias=True)
      (3): Linear(in_features=100, out_features=5, bias=True)
      (4): Linear(in_features=100, out_features=5, bias=True)
      (5): Linear(in_features=100, out_features=1, bias=True)
    )
  )
)
====> Epoch: 1 Average loss: 0.69078142  running time 31.97305130958557
====> Epoch: 1 Average loss: 0.45752051  running time 29.515017986297607
====> Epoch: 1 Average loss: 0.40727848  running time 29.806461095809937
====> Epoch: 1 Average loss: 0.40425841  running time 29.845024347305298
====> Epoch: 1 Average loss: 0.40162378  running time 29.833513736724854
====> Epoch: 1 Average loss: 0.40089892  running time 30.347663640975952
====> Test set BCE loss 0.35869306325912476 Custom Loss 0.35869306325912476 with ber  0.15577499568462372
saved model ./tmp/torch_model_239183.pt
SNRS [-1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
no pos BER specified.
Test SNR -1.5 with ber  0.1241919994354248 with bler 1.0
Punctured Test SNR -1.5 with ber  0.0 with bler 0.0
no pos BER specified.
Test SNR -1.0 with ber  0.111688993871212 with bler 1.0
Punctured Test SNR -1.0 with ber  0.0 with bler 0.0
no pos BER specified.
Test SNR -0.5 with ber  0.09967299550771713 with bler 0.9999000000000001
Punctured Test SNR -0.5 with ber  0.0 with bler 0.0
no pos BER specified.
Test SNR 0.0 with ber  0.08882798999547958 with bler 0.9998
Punctured Test SNR 0.0 with ber  0.0 with bler 0.0
no pos BER specified.
Test SNR 0.5 with ber  0.0782799944281578 with bler 0.9992000000000002
Punctured Test SNR 0.5 with ber  0.0 with bler 0.0
no pos BER specified.
Test SNR 1.0 with ber  0.06850700080394745 with bler 0.9985999999999998
Punctured Test SNR 1.0 with ber  0.0 with bler 0.0
